name: IAM Policy Validator as SARIF
author: George Alton
description: |
  Calls IAM AccessAnalyzer ValidatePolicy API to generate Findings for a Policy.
  Then converts the findings to the SARIF format.
branding:
  icon: check-square
  color: green
inputs:
  policies:
    description: "path to policy/policies"
    required: true
  policy_type:
    default: IDENTITY_POLICY
  locale:
    default: EN
  resource_type:
    required: false
  results:
    description: "where to store results"
    default: "-"
runs:
  using: docker
  image: Dockerfile
  args:
    - "--policy-type ${{ inputs.policy_type }}"
    - "--locale ${{ inputs.locale }}"
    - "${{ inputs.policies }}"
    - "${{ inputs.results }}"
    - "${{ inputs.resource_type }}"
